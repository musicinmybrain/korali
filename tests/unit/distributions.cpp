#include "gtest/gtest.h"
#include "korali.hpp"
#include "modules/distribution/univariate/beta/beta.hpp"

#define PDENSITY_ERROR_TOLERANCE 0.0000001

namespace
{
 using namespace korali;

 TEST(Conduit, BetaDistribution)
 {
  knlohmann::json distributionJs;
  Experiment e;
  distribution::univariate::Beta* d;

  // Creating distribution with an incorrect name
  distributionJs["Type"] = "Distribution/Univariate/Beta";
  ASSERT_ANY_THROW(d = dynamic_cast<korali::distribution::univariate::Beta *>(Module::getModule(distributionJs, &e)));

  // Creating distribution correctly now
  distributionJs["Type"] = "Univariate/Beta";
  ASSERT_NO_THROW(d = dynamic_cast<korali::distribution::univariate::Beta *>(Module::getModule(distributionJs, &e)));

  // Getting module defaults
  distributionJs["Name"] = "Test";
  ASSERT_NO_THROW(d->applyModuleDefaults(distributionJs));
  auto baseJs = distributionJs;

  // Testing correct shape
  distributionJs = baseJs;
  distributionJs["Alpha"] = 0.5;
  distributionJs["Beta"] = 0.5;
  ASSERT_NO_THROW(d->setConfiguration(distributionJs));
  ASSERT_NO_THROW(d->updateDistribution());

  // Testing incorrect shape (alpha)
  d->_alpha = -0.5;
  d->_beta = 0.5;
  ASSERT_ANY_THROW(d->updateDistribution());

  // Testing correct shape (alpha)
  d->_alpha = 0.5;
  d->_beta = 0.5;
  ASSERT_NO_THROW(d->updateDistribution());

  // Distributions generated with https://keisan.casio.com/exec/system/1180573226

  // Testing expected density
  EXPECT_NEAR(d->getDensity( 0.01 ), 3.199134726, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.02 ), 2.273642044, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.03 ), 1.865965599, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.04 ), 1.624368336, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.05 ), 1.460505923, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.06 ), 1.340326411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.07 ), 1.247554804, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.08 ), 1.173305807, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.09 ), 1.112264757, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.10 ), 1.061032954, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.11 ), 1.017322808, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.12 ), 0.979530962, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.13 ), 0.946496091, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.14 ), 0.917353841, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.15 ), 0.891445988, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.16 ), 0.868261398, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.17 ), 0.847396411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.18 ), 0.828527540, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.19 ), 0.811392179, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.20 ), 0.795774716, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.21 ), 0.781496315, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.22 ), 0.768407306, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.23 ), 0.756381411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.24 ), 0.745311308, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.25 ), 0.735105194, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.26 ), 0.725684076, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.27 ), 0.716979627, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.28 ), 0.708932462, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.29 ), 0.701490759, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.30 ), 0.694609118, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.31 ), 0.688247647, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.32 ), 0.682371189, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.33 ), 0.676948696, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.34 ), 0.671952696, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.35 ), 0.667358854, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.36 ), 0.663145596, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.37 ), 0.659293798, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.38 ), 0.655786518, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.39 ), 0.652608771, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.40 ), 0.649747334, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.41 ), 0.647190589, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.42 ), 0.644928375, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.43 ), 0.642951882, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.44 ), 0.641253540, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.45 ), 0.639826945, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.46 ), 0.638666787, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.47 ), 0.637768791, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.48 ), 0.637129680, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.49 ), 0.636747135, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.50 ), 0.636619772, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.51 ), 0.636747135, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.52 ), 0.637129680, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.53 ), 0.637768791, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.54 ), 0.638666787, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.55 ), 0.639826945, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.56 ), 0.641253540, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.57 ), 0.642951882, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.58 ), 0.644928375, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.59 ), 0.647190589, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.60 ), 0.649747334, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.61 ), 0.652608771, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.62 ), 0.655786518, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.63 ), 0.659293798, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.64 ), 0.663145596, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.65 ), 0.667358854, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.66 ), 0.671952696, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.67 ), 0.676948696, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.68 ), 0.682371189, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.69 ), 0.688247647, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.70 ), 0.694609118, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.71 ), 0.701490759, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.72 ), 0.708932462, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.73 ), 0.716979627, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.74 ), 0.725684076, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.75 ), 0.735105194, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.76 ), 0.745311308, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.77 ), 0.756381411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.78 ), 0.768407306, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.79 ), 0.781496315, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.80 ), 0.795774716, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.81 ), 0.811392179, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.82 ), 0.828527540, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.83 ), 0.847396411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.84 ), 0.868261398, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.85 ), 0.891445988, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.86 ), 0.917353841, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.87 ), 0.946496091, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.88 ), 0.979530962, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.89 ), 1.017322808, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.90 ), 1.061032954, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.91 ), 1.112264757, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.92 ), 1.173305807, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.93 ), 1.247554804, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.94 ), 1.340326411, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.95 ), 1.460505923, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.96 ), 1.624368336, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.97 ), 1.865965599, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.98 ), 2.273642044, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getDensity( 0.99 ), 3.199134726, PDENSITY_ERROR_TOLERANCE);

  // Testing log density function
  EXPECT_NEAR(d->getLogDensity( 0.01 ), 1.162880375, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.02 ), 0.821382970, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.03 ), 0.623778667, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.04 ), 0.485119024, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.05 ), 0.378782898, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.06 ), 0.292913175, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.07 ), 0.221185479, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.08 ), 0.159825241, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.09 ), 0.106398258, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.10 ), 0.059242919, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.11 ), 0.017174479, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.12 ), -0.020681432, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.13 ), -0.054988438, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.14 ), -0.086262013, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.15 ), -0.114910429, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.16 ), -0.141262460, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.17 ), -0.165586676, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.18 ), -0.188105202, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.19 ), -0.209003767, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.20 ), -0.228439154, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.21 ), -0.246544845, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.22 ), -0.263435340, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.23 ), -0.279209519, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.24 ), -0.293953285, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.25 ), -0.307741669, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.26 ), -0.320640515, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.27 ), -0.332707853, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.28 ), -0.343995015, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.29 ), -0.354547553, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.30 ), -0.364406012, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.31 ), -0.373606555, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.32 ), -0.382181504, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.33 ), -0.390159790, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.34 ), -0.397567333, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.35 ), -0.404427366, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.36 ), -0.410760711, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.37 ), -0.416586019, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.38 ), -0.421919972, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.39 ), -0.426777455, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.40 ), -0.431171708, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.41 ), -0.435114455, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.42 ), -0.438616014, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.43 ), -0.441685392, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.44 ), -0.444330362, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.45 ), -0.446557537, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.46 ), -0.448372421, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.47 ), -0.449779458, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.48 ), -0.450782065, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.49 ), -0.451382665, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.50 ), -0.451582705, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.51 ), -0.451382665, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.52 ), -0.450782065, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.53 ), -0.449779458, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.54 ), -0.448372421, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.55 ), -0.446557537, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.56 ), -0.444330362, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.57 ), -0.441685392, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.58 ), -0.438616014, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.59 ), -0.435114455, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.60 ), -0.431171708, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.61 ), -0.426777455, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.62 ), -0.421919972, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.63 ), -0.416586019, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.64 ), -0.410760711, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.65 ), -0.404427366, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.66 ), -0.397567333, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.67 ), -0.390159790, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.68 ), -0.382181504, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.69 ), -0.373606555, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.70 ), -0.364406012, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.71 ), -0.354547553, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.72 ), -0.343995015, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.73 ), -0.332707853, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.74 ), -0.320640515, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.75 ), -0.307741669, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.76 ), -0.293953285, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.77 ), -0.279209519, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.78 ), -0.263435340, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.79 ), -0.246544845, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.80 ), -0.228439154, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.81 ), -0.209003767, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.82 ), -0.188105202, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.83 ), -0.165586676, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.84 ), -0.141262460, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.85 ), -0.114910429, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.86 ), -0.086262013, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.87 ), -0.054988438, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.88 ), -0.020681432, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.89 ), 0.017174479, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.90 ), 0.059242919, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.91 ), 0.106398258, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.92 ), 0.159825241, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.93 ), 0.221185479, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.94 ), 0.292913175, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.95 ), 0.378782898, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.96 ), 0.485119024, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.97 ), 0.623778667, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.98 ), 0.821382970, PDENSITY_ERROR_TOLERANCE);
  EXPECT_NEAR(d->getLogDensity( 0.99 ), 1.162880375, PDENSITY_ERROR_TOLERANCE);

  // Testing extreme cases for log density
  EXPECT_EQ(d->getLogDensity( -0.001 ), -INFINITY);
  EXPECT_EQ(d->getLogDensity( 1.001 ), -INFINITY);

 // Checking random numbers are within the expected range
  for (size_t i = 0; i < 100; i++)
  {
   double x = d->getRandomNumber();
   EXPECT_TRUE((x >= 0.0) && (x <= 1.0));
  }

  // Testing extreme for log density gradient and hessian
  EXPECT_EQ(d->getLogDensityGradient( -0.001 ), 0.0);
  EXPECT_EQ(d->getLogDensityGradient( 1.001 ), 0.0);
  EXPECT_EQ(d->getLogDensityHessian( -0.001 ), 0.0);
  EXPECT_EQ(d->getLogDensityHessian( 1.001 ), 0.0);

  // Normal case for log density gradient and hessian
  ASSERT_NO_THROW(d->getLogDensityGradient( 0.5 ));
  ASSERT_NO_THROW(d->getLogDensityHessian( 0.5 ));
 }


} // namespace
