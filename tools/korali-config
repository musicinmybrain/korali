
CXXFLAGS="-I$PREFIX/include -I$PREFIX/lib/koraligsl/include/gsl"
CXXFLAGS="$CXXFLAGS -Wno-unused -Wunused-result -Wno-unused-parameter -Wno-address -Wno-deprecated-declarations -Wall -Wfatal-errors"
LDFLAGS="-Wl,-rpath=$PREFIX/lib/koraligsl/lib -L$PREFIX/lib/koraligsl/lib -lgsl -lgslcblas -L$PREFIX/lib -l:libkorali.a" 

if [ $USE_UPCXX -eq 1 ]; then
 CXXFLAGS="$CXXFLAGS `upcxx-meta CPPFLAGS`"
 LDFLAGS="$LDFLAGS `upcxx-meta LIBS`" 
fi

if [ $USE_MULTITHREAD -eq 1 ]; then
 CXXFLAGS="$CXXFLAGS -pthread"
fi

usage()
{
    cat <<EOF
Usage: korali-config [OPTION]

Known values for OPTION are:

  --prefix		show korali installation prefix 
  --python		print Python related information for Korali.
  --cxx  		print cxx compiler/wrapper to build a Korali app.
  --libs		print korali library linking information
  --cflags		print pre-processor and compiler flags
  --help		display this help and exit
  --version		output version information

EOF

    exit $1
}

if test $# -eq 0; then
    usage 1
fi

while test $# -gt 0; do
    case "$1" in
    -*=*) optarg=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
    *) optarg= ;;
    esac

    case "$1" in
    --prefix=*)
	PREFIX=$optarg
	;;

    --python)
	echo "[Korali] Compiling with Python configuration:"
        echo "CXXFLAGS=`python-config --cflags`"
        echo "LIBS=`python-config --libs`"
        echo "[Korali] To run a korali application, make sure you define:"
        echo '[Korali] >export PATH=$PATH:'$PREFIX'/bin'
	echo '[Korali] >export PYTHONPATH=$PYTHONPATH:'$PREFIX'/lib'
	;;

    --prefix)
	echo $PREFIX
	;;

    --version)
	echo $VERSION
	exit 0
	;;

    --help)
	usage 0
	;;

    --libs)
	echo $LDFLAGS
       	;;

    --cflags)
       	echo $CXXFLAGS
       	;;

    --cxx)
       	echo $CXX
       	;;

    *)
	usage
	exit 1
	;;
    esac
    shift
done

exit 0
