#include "problems/bayesian/custom/custom.hpp"
#include "conduits/base.hpp"
#include "engine/engine.hpp"

void Korali::Problem::Bayesian::Custom::initialize()
{
  Korali::Problem::Bayesian::Base::initialize();

  if (_k->_variables.size() == 0) Korali::logError("Bayesian inference problems require at least one variable.\n");
  if (_statisticalVariableIndices.size() != 0) Korali::logError("Bayesian (Custom) problems do not accept statistical variables.\n");
}

double Korali::Problem::Bayesian::Custom::evaluateLogLikelihood(Korali::Sample& sample)
{
 _k->_conduit->runModel(_likelihoodModel, sample);
 std::vector<double> result = sample.getResult();
 if (result.size() != 1) Korali::logError("The specified likelihood model did not return a single result. Received: %lu results.\n", result.size());
 return result[0];
}

