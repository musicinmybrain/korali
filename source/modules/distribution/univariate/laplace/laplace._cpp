#include "modules/distribution/univariate/laplace/laplace.hpp"
#include "modules/experiment/experiment.hpp"
#include <gsl/gsl_randist.h>
#include <gsl/gsl_sf.h>

@startNamespace

double @className::getDensity(const double x) const
{
  return gsl_ran_laplace_pdf(x - _mean, _width);
}

double @className::getLogDensity(const double x) const
{
  return _aux - fabs(x - _mean) / _width;
}

double @className::getRandomNumber()
{
  return _mean + gsl_ran_laplace(_range, _width);
}

void @className::updateDistribution()
{
  if (_width <= 0.0) KORALI_LOG_ERROR("Incorrect Width parameter of Laplace distribution: %f.\n", _width);

  _aux = -gsl_sf_log(2. * _width);
}

@moduleAutoCode

@endNamespace
