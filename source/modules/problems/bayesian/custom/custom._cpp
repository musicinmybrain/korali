#include "modules/problems/bayesian/custom/custom.hpp"
#include "modules/engine/engine.hpp"

void Korali::Problem::Bayesian::Custom::initialize()
{
  Korali::Problem::Bayesian::Base::initialize();

  if (_variables.size() == 0) Korali::logError("Bayesian inference problems require at least one variable.\n");
  if (_statisticalVariableIndices.size() != 0) Korali::logError("Bayesian (Custom) problems do not accept statistical variables.\n");
}

void Korali::Problem::Bayesian::Custom::runModel(std::vector<double> target, size_t targetId)
{
  _modelData.setSample(targetId, target);

  _likelihoodModel(_modelData);
}

double Korali::Problem::Bayesian::Custom::evaluateLogLikelihood()
{
  if (_modelData.getResultsSize() != 1)
   Korali::logError("The specified likelihood model did not return a single result. Received: %lu results.\n", _modelData.getResultsSize());

  double logLikelihood =  _modelData.getResults()[0];

  return logLikelihood;
}

